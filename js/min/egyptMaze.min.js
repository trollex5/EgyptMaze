"use strict";var sysData,MainController=function(){function t(i,e,s,n,o){var a=this;if(this._cMain=new PIXI.Container,this._sChooseContainer=new PIXI.Container,this._parterContainer=new PIXI.Container,this._showViewContainer=new PIXI.Container,this._gameViewContainer=new PIXI.Container,this._endGameViewContainer=new PIXI.Container,this._rLoader=new ResourceLoader,this._queu=[],this._purchased=[],this._currentState="SOUND_CHOOSE",this._nextState="",this._viewCounter=0,this._numView=1,this._gameLevel=1,this._loadImgCounter=0,this._allImageLoaded=0,this._progress=0,this._time=100,this._money=0,this._allowTransition=!0,this._sChooseAllow=!0,this._parterAllow=!1,this._shopViewAllow=!1,this._gameViewAllow=!1,this._endGameViewAllow=!1,this._playGame=!1,this._subgameEnd=!1,this._isLoged=!0,this._allSounds={0:{name:"btnClick",path:"sounds/buttonClick.mp3"},1:{name:"btnBuyClick",path:"sounds/buyButtons.mp3"},3:{name:"timeIsUpSound",path:"sounds/time_is_up.mp3"},4:{name:"getStuff",path:"sounds/get_stuff.mp3"},6:{name:"shopLoop",path:"sounds/shop_loop.mp3"},7:{name:"gameLoop",path:"sounds/game_loop.mp3"},9:{name:"ballMove",path:"sounds/ball_move.mp3"}},this._uName="undefined",t.IS_MOBILE=s,this._isLoged=n,this._uName=o,this._dispachtElement=i,this._dispachtElement.addEventListener("SoundChooseLoadCompleate",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("gameWithSound",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("gameWithoutSound",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("allViewImagesloaded",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("buttonbtn1Timeclicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("buttonbtn10Timeclicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("buttonbtn1Moneyclicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("buttonbtn10Moneyclicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("buttonbtnPlayclicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("buttonbtnShopclicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("buttonbtnGreanStateclicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("buttonbtnShopBackclicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("scarabClicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("woodTorchClicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("shoesClicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("eyeOfRaClicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("papyrusClicked",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("hitCoin",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("hitMoneyCase",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("timeOver",function(t){a.dispatchCommand(t)}),this._dispachtElement.addEventListener("hitExit",function(t){a.dispatchCommand(t)}),this._IOS=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),this._renderer=e,window.addEventListener("orientationchange",function(){a.orientationDivace(!0)}),this._sChoose=new SoundChoose(this._sChooseContainer,this._dispachtElement),this.loadImages(this._sChoose.getResouces(),this.soundChooseLoadCompleate),this._fsBtn=PIXI.Sprite.fromImage("pics/full_screen_button.gif"),this._fsBtn.x=950,this._fsBtn.y=5,this._fsBtn.scale.x=.7,this._fsBtn.scale.y=.7,this._fsBtn.buttonMode=!0,this._fsBtn.interactive=!0,this._fsBtn.on("pointerup",function(){a._sChoose.simulateFullScreen()}),this._recScreen=document.getElementById("recordContainer"),null===this._recScreen)throw new Error("!!!*** recScreen is not initialized ***!!!");this._cMain.addChild(this._sChooseContainer),this._cMain.addChild(this._parterContainer),this._cMain.addChild(this._showViewContainer),this._cMain.addChild(this._gameViewContainer),this._cMain.addChild(this._endGameViewContainer),this._cMain.addChild(this._fsBtn)}return t.prototype.orientationDivace=function(i){t.LANDSCAPE=i?!(window.innerWidth>window.innerHeight):window.innerWidth>window.innerHeight,console.log("!!!!!!!!!!!!!!!!!!!!!! ",i),console.log("Main orientation divace landscape : ",t.LANDSCAPE,window.innerWidth,window.innerHeight);var e=t.LANDSCAPE?1366:768,s=t.LANDSCAPE?768:1366;this._renderer.resize(e,s),this._sChoose&&this._sChoose.orientation(t.LANDSCAPE),this._parter&&this._parter.orientation(t.LANDSCAPE),this._shopView&&this._shopView.orientation(t.LANDSCAPE),this._gameView&&this._gameView.orientation(t.LANDSCAPE),this._endGameView&&this._endGameView.orientation(t.LANDSCAPE)},t.prototype.loadImages=function(t,i){t.length<=0&&console.log("!!!***********Empty resource object***********!!!");var e=t;this._allImageLoaded+=e.length,this._rLoader.loadResources(e,this,this.oneResourceLoaded,i)},t.prototype.oneResourceLoaded=function(t,i){t._loadImgCounter++,t._progress=Math.round(t._loadImgCounter/t._allImageLoaded*100),t._loadImgCounter>0&&t._loadImgCounter<t._allImageLoaded+1&&t._progress<101?t._sChoose.setProgressBar(t._progress):console.log("that._loadImgCounter > 0 && that._loadImgCounter < that._allImageLoaded+1 && that._progress < 101 :",t._loadImgCounter,t._allImageLoaded+1,t._progress)},t.prototype.soundChooseLoadCompleate=function(t){if(t._allImageLoaded===t._loadImgCounter){var i=new CustomEvent("SoundChooseLoadCompleate");setTimeout(function(){t._dispachtElement.dispatchEvent(i)},10)}},t.prototype.loadCompleate=function(t){if(t._allImageLoaded===t._loadImgCounter){var i=new CustomEvent("allViewImagesloaded");setTimeout(function(){t._dispachtElement.dispatchEvent(i)},10)}},t.prototype.loadOtherImages=function(){var t=[];this._parter=new Parter(this._parterContainer),this._parter.getResouces().forEach(function(i){t.push(i)}),this._shopView=new ShopView(this._showViewContainer,this._dispachtElement),this._shopView.getResouces().forEach(function(i){t.push(i)}),this._gameView=new GameView(this._gameViewContainer,this._dispachtElement),this._gameView.getResouces().forEach(function(i){t.push(i)}),this._endGameView=new EndGameView(this._endGameViewContainer),this.loadImages(t,this.loadCompleate)},t.prototype.makeAllSoundsJs=function(){if(createjs.Sound.initializeDefaultPlugins())for(var t in createjs.Sound.addEventListener("fileload",createjs.proxy(this.soundLoaded,this)),this._allSounds)createjs.Sound.registerSound(this._allSounds[t].path,this._allSounds[t].name)},t.prototype.soundLoaded=function(t){console.log("++++++++++",t)},t.prototype.moveBall=function(t){this._playGame&&this._gameView.moveBall(t)},t.prototype.stopBallMove=function(){t.HAVE_SOUND&&this._gameView.stopBallSound()},t.prototype.dispatchCommand=function(t){var i=this;setTimeout(function(){i.doit(t.type,t.detail)},10)},t.prototype.doit=function(i,e){var s,n=this;if(""==i&&null==i||(s={command:i,param:e},this._queu.push(s)),console.log("____ ",this._allowTransition,this._queu.length,this._currentState),this._allowTransition&&this._queu.length>0){switch(this._allowTransition=!1,this._currentState){case"SOUND_CHOOSE":switch(console.log("STATE-SOUND_CHOOSE",this._queu[0].command),this._queu[0].command){case"SoundChooseLoadCompleate":this._sChoose.createInterface(),this.orientationDivace(!1),this._nextState="SOUND_CHOOSE";break;case"gameWithSound":t.HAVE_SOUND=!0,this.makeAllSoundsJs(),this.loadOtherImages(),this._nextState="SOUND_CHOOSE";break;case"gameWithoutSound":t.HAVE_SOUND=!1,this.loadOtherImages(),this._nextState="SOUND_CHOOSE";break;case"allViewImagesloaded":this._sChooseAllow=!1,this._parter.createInterface(),this._shopView.createInterface(),this._gameView.createInterface(),this._endGameView.createInterface(),this.orientationDivace(!1),this._parterAllow=!0,this._nextState="PARTER"}this._currentState=this._nextState;break;case"PARTER":switch(console.log("STATE-PARTER",this._queu[0].command),this._queu[0].command){case"buttonbtnPlayclicked":t.HAVE_SOUND&&createjs.Sound.play("btnClick"),this._gameView.setMoney(this._money),this._gameView.setTime(this._time),this._gameView.setLevel(this._gameLevel),this._gameView.restoreInit(),this._gameView.startStuff(this._purchased),this._gameViewAllow=!0,this._parterAllow=!1,this._endGameViewAllow=!1,this._gameView.playDisable(!1),this._nextState="GAME_READY";break;case"buttonbtnShopclicked":t.HAVE_SOUND&&createjs.Sound.play("btnClick"),this._shopView.setMoney(this._money),this._shopView.begin(this._subgameEnd),setTimeout(function(){t.HAVE_SOUND&&(n._shopLoopSound=createjs.Sound.play("shopLoop",{loop:-1}),n._shopLoopSound.volume=.2),n._shopViewAllow=!0,n._parterAllow=!1},300),this._nextState="SHOP";break;case"buttonbtn1Timeclicked":t.HAVE_SOUND&&createjs.Sound.play("btnBuyClick"),this._money>0&&(this._parter.rotateClock(),this._parter.setTime(this._time+=1),this._parter.setMoney(this._money-=1)),this._nextState="PARTER";break;case"buttonbtn10Timeclicked":t.HAVE_SOUND&&createjs.Sound.play("btnBuyClick"),this._money>9&&(this._parter.rotateClock(),this._parter.setTime(this._time+=10),this._parter.setMoney(this._money-=10)),this._nextState="PARTER";break;case"buttonbtn1Moneyclicked":t.HAVE_SOUND&&createjs.Sound.play("btnBuyClick"),this._time>0&&(this._parter.rotateMoney(),this._parter.setMoney(this._money+=1),this._parter.setTime(this._time-=1)),this._nextState="PARTER";break;case"buttonbtn10Moneyclicked":t.HAVE_SOUND&&createjs.Sound.play("btnBuyClick"),this._time>9&&(this._parter.rotateMoney(),this._parter.setMoney(this._money+=10),this._parter.setTime(this._time-=10)),this._nextState="PARTER"}this._currentState=this._nextState;break;case"SHOP":switch(console.log("STATE-SHOP",this._queu[0].command),this._queu[0].command){case"buttonbtnShopBackclicked":t.HAVE_SOUND&&createjs.Sound.play("btnClick"),this._subgameEnd=!1,this._parter.setMoney(this._money),setTimeout(function(){t.HAVE_SOUND&&n._shopLoopSound.stop("shop_loop"),n._shopViewAllow=!1,n._parterAllow=!0},300),this._nextState="PARTER";break;case"scarabClicked":if(1===this._queu[0].param[0])this._shopView.setScarab(1),this._shopView.showStuffDescription(!0);else if(2===this._queu[0].param[0])this._money-this._queu[0].param[1]>=0?(this._shopView.setMoney(this._money-=this._queu[0].param[1]),this._shopView.setScarab(2),this._shopView.showStuffDescription(!0),this._purchased.push("scarab")):(this._shopView.setScarab(0),this._shopView.showStuffDescription(!1));else if(3===this._queu[0].param[0]){this._shopView.setScarab(0),this._shopView.showStuffDescription(!1),this._shopView.setMoney(this._money+=this._queu[0].param[1]);var o=this._purchased.indexOf("scarab");this._purchased.splice(o,1)}break;case"woodTorchClicked":if(1===this._queu[0].param[0])this._shopView.setWoodTorch(1),this._shopView.showStuffDescription(!0);else if(2===this._queu[0].param[0])this._money-this._queu[0].param[1]>=0?(this._shopView.setMoney(this._money-=this._queu[0].param[1]),this._shopView.setWoodTorch(2),this._shopView.showStuffDescription(!0),this._purchased.push("woodTorch")):(this._shopView.setWoodTorch(0),this._shopView.showStuffDescription(!1));else if(3===this._queu[0].param[0]){this._shopView.setWoodTorch(0),this._shopView.showStuffDescription(!1),this._shopView.setMoney(this._money+=this._queu[0].param[1]);o=this._purchased.indexOf("woodTorch");this._purchased.splice(o,1)}break;case"shoesClicked":if(1===this._queu[0].param[0])this._shopView.setShoes(1),this._shopView.showStuffDescription(!0);else if(2===this._queu[0].param[0])this._money-this._queu[0].param[1]>=0?(this._shopView.setMoney(this._money-=this._queu[0].param[1]),this._shopView.setShoes(2),this._shopView.showStuffDescription(!0),this._purchased.push("shoes")):(this._shopView.setShoes(0),this._shopView.showStuffDescription(!1));else if(3===this._queu[0].param[0]){this._shopView.setShoes(0),this._shopView.showStuffDescription(!1),this._shopView.setMoney(this._money+=this._queu[0].param[1]);o=this._purchased.indexOf("shoes");this._purchased.splice(o,1)}break;case"eyeOfRaClicked":if(1===this._queu[0].param[0])this._shopView.setEyeOfRa(1),this._shopView.showStuffDescription(!0);else if(2===this._queu[0].param[0])this._money-this._queu[0].param[1]>=0?(this._shopView.setMoney(this._money-=this._queu[0].param[1]),this._shopView.setEyeOfRa(2),this._shopView.showStuffDescription(!0),this._purchased.push("eyeOfRa")):(this._shopView.setEyeOfRa(0),this._shopView.showStuffDescription(!1));else if(3===this._queu[0].param[0]){this._shopView.setEyeOfRa(0),this._shopView.showStuffDescription(!1),this._shopView.setMoney(this._money+=this._queu[0].param[1]);o=this._purchased.indexOf("eyeOfRa");this._purchased.splice(o,1)}break;case"papyrusClicked":if(1===this._queu[0].param[0])this._shopView.setPapyrus(1),this._shopView.showStuffDescription(!0);else if(2===this._queu[0].param[0])this._money-this._queu[0].param[1]>=0?(this._shopView.setMoney(this._money-=this._queu[0].param[1]),this._shopView.setPapyrus(2),this._shopView.showStuffDescription(!0),this._purchased.push("papyrus")):(this._shopView.setPapyrus(0),this._shopView.showStuffDescription(!1));else if(3===this._queu[0].param[0]){this._shopView.setPapyrus(0),this._shopView.showStuffDescription(!1),this._shopView.setMoney(this._money+=this._queu[0].param[1]);o=this._purchased.indexOf("papyrus");this._purchased.splice(o,1)}}this._currentState=this._nextState;break;case"GAME_READY":switch(console.log("STATE-GAME_READY",this._queu[0].command),this._queu[0].command){case"buttonbtnPlayclicked":t.HAVE_SOUND&&createjs.Sound.play("btnClick"),this._gameView.playDisable(!0),setTimeout(function(){t.HAVE_SOUND&&(n._gameLoopSound=createjs.Sound.play("gameLoop",{loop:-1})),n._playGame=!0,n._gameView.startGameTime()},300),this._nextState="PLAY_GAME"}this._currentState=this._nextState;break;case"PLAY_GAME":switch(console.log("STATE-PLAY_GAME",this._queu[0].command),this._queu[0].command){case"papyrusClicked":case"scarabClicked":case"shoesClicked":case"woodTorchClicked":case"eyeOfRaClicked":this._nextState="PLAY_GAME";break;case"hitCoin":this._gameView.setMoney(this._money+=10),this._nextState="PLAY_GAME";break;case"hitMoneyCase":var a=Math.floor(45*Math.random()+15);this._money+=a,this._gameView.startMoneyCaseAnim(a),this._nextState="PLAY_GAME";break;case"timeOver":this._time=0,this._purchased=[],t.HAVE_SOUND&&this._gameLoopSound.stop("gameLoop"),setTimeout(function(){n._isLoged?(console.log("^^^^^^^^^^^^^^^^^^^^^^^^^^^^"),document.getElementById("textinput").value=n._uName,document.getElementById("textinputScore").value=n._gameLevel,n._recScreen.style.display="block"):(n._gameViewAllow=!1,n._endGameViewAllow=!0)},3e3),this._nextState="GAME_OVER";break;case"hitExit":this._subgameEnd=!0,t.HAVE_SOUND&&this._gameLoopSound.stop("gameLoop"),this._purchased=[],this._time=this._queu[0].param[0],this._gameLevel++,this._parter.setMoney(this._money),this._parter.setTime(this._time),setTimeout(function(){n._gameViewAllow=!1,n._parterAllow=!0},3e3),this._nextState="PARTER"}this._currentState=this._nextState;break;case"GAME_OVER":switch(console.log("STATE-GAME_OVER",this._queu[0].command),this._queu[0].command){case"buttonbtnPlayclicked":t.HAVE_SOUND&&createjs.Sound.play("btnClick"),window.location.href="http://tgg-bg.com",this._nextState="PLAY_GAME"}this._currentState=this._nextState;break;default:console.log("!!! STARTE-MACHINE controler - defoult case !!!")}this._queu.shift(),this._allowTransition=!0,this._queu.length>0&&this.doit("",[])}},t.prototype.animate=function(){var t=this;this._sChooseContainer.visible=this._sChooseAllow,this._parterContainer.visible=this._parterAllow,this._showViewContainer.visible=this._shopViewAllow,this._gameViewContainer.visible=this._gameViewAllow,this._endGameViewContainer.visible=this._endGameViewAllow,window.fullscreen||window.innerHeight==screen.height?this._fsBtn.visible=!1:this._IOS||(this._fsBtn.visible=!0),this._renderer.render(this._cMain),requestAnimationFrame(function(){return t.animate()})},t.IS_MOBILE=!1,t.HAVE_SOUND=!1,t.LANDSCAPE=!1,t}(),ResourceLoader=function(){function t(){this._loader=new PIXI.loaders.Loader,this._imgCounter=0}return t.prototype.loadResources=function(t,i,e,s){this._loader=new PIXI.loaders.Loader,this._allImage=t;for(var n=0;n<this._allImage.length;n++)this._loader.add(this._allImage[n].name,this._allImage[n].url);this._loader.onLoad.add(function(t){e(i)}),this._loader.onError.add(function(t){}),this._loader.load(function(t,i){console.log("load image---",i),sysData=i}),this._loader.onComplete.add(function(){s(i)})},t}(),StoneTile=function(){function t(t,i,e,s){this._degree=0,this._degree=s,this._tileRect=new PIXI.Rectangle(0,0,i,e),this._texture=new PIXI.Texture(PIXI.BaseTexture.fromImage(sysData[t].url),this._tileRect),this._tile=new PIXI.Sprite(this._texture),s>0&&(this._tile.rotation=2*Math.PI*.25)}return Object.defineProperty(t.prototype,"tile",{get:function(){return this._tile},enumerable:!0,configurable:!0}),t.prototype.setX=function(t){this._tile.x=t,this._degree>0&&(this._tile.x+=10)},t.prototype.setY=function(t){this._tile.y=t},t}(),__extends=this&&this.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),AnimationTiles=function(t){function i(i,e,s,n,o){var a=t.call(this)||this;return a._x=0,a._y=0,a._width=e,a._height=s,a._tiles=n,a._tileRect=new PIXI.Rectangle(0,0,e,s),a._texture=new PIXI.Texture(PIXI.BaseTexture.fromImage(sysData[i].url),a._tileRect),a._sprite=new PIXI.Sprite(a._texture),a._sprite.anchor.set(.5),a._randomStart=Math.floor(6e3*Math.random()+3e3),null!=o&&(a._cMain=o,a._cMain.addChild(a._sprite)),a}return __extends(i,t),Object.defineProperty(i.prototype,"sprite",{get:function(){return this._sprite},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"x",{get:function(){return this._sprite.x},set:function(t){t>0&&(this._sprite.x=t)},enumerable:!0,configurable:!0}),i.prototype.startAnim=function(){var t=this;this._startTimer=setInterval(function(){t.animation()},this._randomStart)},i.prototype.stopTimer=function(){clearInterval(this._startTimer)},i.prototype.animation=function(){var t=this;clearInterval(this._animTimer),this._animTimer=setInterval(function(){t._tileRect.x+=t._width,t._tileRect.x>t._width*(t._tiles-1)&&(t._tileRect.x=0,clearInterval(t._animTimer)),t._sprite.texture.frame=t._tileRect},40)},i}(PIXI.Sprite),Button=function(){function t(t,i,e,s,n,o,a){var h=this;this._status=!0,this._cMain=t,this._btnName=i,this._imgName=e,this._symbol=s,this._tiles=n,this._width=o,this._height=a,this._imgRect=new PIXI.Rectangle(0,0,this._width,this._height),this._imgTexture=new PIXI.Texture(PIXI.BaseTexture.fromImage(sysData[this._imgName].url),this._imgRect),this._imgSprite=new PIXI.Sprite(this._imgTexture),this._imgSprite.texture.frame=this._imgRect,this._imgSprite.anchor.set(.5),this._imgSprite.interactive=!0,this._imgSprite.buttonMode=!0,this._imgSprite.name=this._imgName,this._imgSprite.on("pointerdown",function(){h.clickBtn()}),this._cMain.addChild(this._imgSprite),"none"!=this._symbol&&(this._symbolRect=new PIXI.Rectangle(0,0,this._width,this._height),this._symbolSprite=PIXI.Sprite.fromImage(sysData[this._symbol].url),this._symbolSprite.texture.frame=this._symbolRect,this._symbolSprite.anchor.set(.5),this._symbolSprite.interactive=!1,this._symbolSprite.name=this._symbol,this._imgSprite.addChild(this._symbolSprite))}return Object.defineProperty(t.prototype,"x",{set:function(t){this._imgSprite.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{set:function(t){this._imgSprite.y=t},enumerable:!0,configurable:!0}),t.prototype.clickBtn=function(){if(this._imgSprite.buttonMode){this._imgSprite.buttonMode=!1;var t=this;this._animTimer=setInterval(function(){if(t._imgRect.x+=t._width,t._imgRect.x>t._width*(t._tiles-1)){t._imgRect.x=0,clearInterval(t._animTimer),t._imgSprite.buttonMode=!0;var i=new CustomEvent("button"+t._btnName+"clicked");dispachtElement.dispatchEvent(i)}t._imgSprite.texture.frame=t._imgRect},40)}},t.prototype.disable=function(){this._imgRect.x=(this._tiles-1)*this._width,this._imgSprite.texture.frame=this._imgRect,this._imgSprite.buttonMode=!1,this._imgSprite.interactive=!1,this._status=!1},t.prototype.enable=function(){this._imgRect.x=0,this._imgSprite.texture.frame=this._imgRect,this._imgSprite.buttonMode=!0,this._imgSprite.interactive=!0,this._status=!0},Object.defineProperty(t.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),t}(),Parter=function(){function t(t){this._innerC=new PIXI.Container,this._images=[{name:"frame",url:"pics/1366x768/frame.png"},{name:"framePortrait",url:"pics/1366x768/frame_portrait.png"},{name:"backgroundLandscape",url:"pics/1366x768/piramid_bg.png"},{name:"backgroundPortrait",url:"pics/1366x768/piramid_bg_portrait.png"},{name:"payTable",url:"pics/1366x768/pay_bg_gold.png"},{name:"btn1",url:"pics/1366x768/btn_1.png"},{name:"btn10",url:"pics/1366x768/btn_10.png"},{name:"btnPlayGreen",url:"pics/1366x768/btn_play_green.png"},{name:"btnShopBlue",url:"pics/1366x768/btn_shop_blue.png"},{name:"btnPlaySymbol",url:"pics/1366x768/btn_play_sign.png"},{name:"btnShopSymbol",url:"pics/1366x768/btn_shop_sign.png"},{name:"clockTime",url:"pics/1366x768/sand_clock_sign.png"},{name:"cash",url:"pics/1366x768/dollar_sign.png"}],this._cMain=t,this._innerC.x=0,this._innerC.y=0,this._cMain.addChild(this._innerC)}return t.prototype.createInterface=function(){console.log("createInterface Parter"),this._frameTexture=PIXI.Texture.fromImage(sysData.frame.url),this._framePortraitTexture=PIXI.Texture.fromImage(sysData.framePortrait.url),this._frame=new PIXI.Sprite(this._frameTexture),this._frame.x=0,this._frame.y=0,this._backgroundLandscape=PIXI.Texture.fromImage(sysData.backgroundLandscape.url),this._backgroundPortrait=PIXI.Texture.fromImage(sysData.backgroundPortrait.url),this._background=new PIXI.Sprite(this._backgroundLandscape),this._background.x=60,this._background.y=60,this._innerC.addChild(this._frame),this._innerC.addChild(this._background),this._payTable=PIXI.Sprite.fromImage(sysData.payTable.url),this._payTable.anchor.set(.5),this._innerC.addChild(this._payTable),this._btn1Time=new Button(this._innerC,"btn1Time",sysData.btn1.name,"none",5,96,96),this._btn10Time=new Button(this._innerC,"btn10Time",sysData.btn10.name,"none",5,96,96),this._btn1Money=new Button(this._innerC,"btn1Money",sysData.btn1.name,"none",5,96,96),this._btn10Money=new Button(this._innerC,"btn10Money",sysData.btn10.name,"none",5,96,96),this._btnShop=new Button(this._innerC,"btnShop",sysData.btnShopBlue.name,sysData.btnShopSymbol.name,7,100,100),this._btnPlay=new Button(this._innerC,"btnPlay",sysData.btnPlayGreen.name,sysData.btnPlaySymbol.name,7,100,100),this._clockTime=PIXI.Sprite.fromImage(sysData.clockTime.url),this._clockTime.anchor.set(.5),this._innerC.addChild(this._clockTime),this._cash=PIXI.Sprite.fromImage(sysData.cash.url),this._cash.anchor.set(.5),this._innerC.addChild(this._cash),this._timeTxt=new PIXI.Text("100",{fontFamily:"Arial",fontSize:50,fill:16711680,fontWeight:"bold",align:"center"}),this._timeTxt.anchor.set(.5,0),this._innerC.addChild(this._timeTxt),this._moneyTxt=new PIXI.Text("0",{fontFamily:"Arial",fontSize:50,fill:90140,fontWeight:"bold",align:"center"}),this._moneyTxt.anchor.set(.5,0),this._innerC.addChild(this._moneyTxt)},t.prototype.orientation=function(t){console.log("******************** ",t),t?(this._background.texture=this._backgroundLandscape,this._frame.texture=this._frameTexture,this._payTable.x=683,this._payTable.y=408.5,this._btn1Time.x=483,this._btn1Time.y=520,this._btn10Time.x=593,this._btn10Time.y=520,this._btn1Money.x=770,this._btn1Money.y=520,this._btn10Money.x=880,this._btn10Money.y=520,this._btnShop.x=1060,this._btnShop.y=453,this._btnPlay.x=1060,this._btnPlay.y=565,this._clockTime.x=540,this._clockTime.y=310,this._cash.x=830,this._cash.y=310,this._timeTxt.position.set(535,405),this._moneyTxt.position.set(830,405)):(this._background.texture=this._backgroundPortrait,this._frame.texture=this._framePortraitTexture,this._payTable.x=384,this._payTable.y=683,this._btn1Time.x=191,this._btn1Time.y=800,this._btn10Time.x=301,this._btn10Time.y=800,this._btn1Money.x=470,this._btn1Money.y=800,this._btn10Money.x=580,this._btn10Money.y=800,this._btnShop.x=525,this._btnShop.y=950,this._btnPlay.x=640,this._btnPlay.y=950,this._clockTime.x=247,this._clockTime.y=583,this._cash.x=532,this._cash.y=583,this._timeTxt.position.set(240,680),this._moneyTxt.position.set(530,680))},t.prototype.getResouces=function(){return this._images},t.prototype.rotateClock=function(){var t=this,i=0;this._rotateTimer=setInterval(function(){i++,t._clockTime.rotation=.45*i,7===i&&clearInterval(t._rotateTimer)},20)},t.prototype.rotateMoney=function(){var t=this,i=0;this._rotateTimer=setInterval(function(){i++,t._cash.rotation=.45*i,7===i&&clearInterval(t._rotateTimer)},20)},t.prototype.setTime=function(t){if(!(t>=0))throw console.log("time value : ",t),new Error("!!!***Invalid time value***!!!");this._timeTxt.text=t.toString(),0==t?(this._btn1Time.disable(),this._btn10Time.disable()):t>0&&t<10&&(this._btn1Time.enable(),this._btn10Time.disable()),this.checkButtonState()},t.prototype.setMoney=function(t){if(!(t>=0))throw console.log("money value : ",t),new Error("!!!***Invalid money value***!!!");this._moneyTxt.text=t.toString(),0==t?(this._btn1Money.disable(),this._btn10Money.disable()):t>0&&t<10&&(this._btn1Money.enable(),this._btn10Money.disable()),this.checkButtonState()},t.prototype.checkButtonState=function(){var t=parseInt(this._timeTxt.text),i=parseInt(this._moneyTxt.text);this._btn1Money.enable(),this._btn10Money.enable(),this._btn1Time.enable(),this._btn10Time.enable(),this._btnPlay.enable(),0==t&&(this._btn1Money.disable(),this._btn10Money.disable(),this._btnPlay.disable()),t<10&&this._btn10Money.disable(),0==i&&(this._btn1Time.disable(),this._btn10Time.disable()),i<10&&this._btn10Time.disable()},t}(),ShopView=function(){function t(t,i){this._innerC=new PIXI.Container,this._images=[{name:"shopBg",url:"pics/1366x768/shop_bg.png"},{name:"btnShopBackSymbol",url:"pics/1366X768/btn_back_arrow_sign.png"},{name:"scarabAnim",url:"pics/scarab_anim.png"},{name:"woodTorchAnim",url:"pics/wood_torch_anim.png"},{name:"shoesAnim",url:"pics/shoes_anim.png"},{name:"eyeOfRa",url:"pics/eye_of_ra.gif"},{name:"papyrusAnim",url:"pics/papyrus_anim.png"}],this._allStuffPos=[],this._stuffState={scarab:{click:0,pos:[[480,690],[480,690]]},woodTorch:{click:0,pos:[[250,608],[250,608]]},shoes:{click:0,pos:[[250,690],[250,690]]},eyeOfRa:{click:0,pos:[[330,690],[330,690]]},papyrus:{click:0,pos:[[405,690],[405,690]]}},this._scarabC=new PIXI.Container,this._woodTorchC=new PIXI.Container,this._shoesC=new PIXI.Container,this._eyeOfRaC=new PIXI.Container,this._papyrusC=new PIXI.Container,this._allStuffs=[],this._stuffBox=new PIXI.Container,this._cMain=t,this._dispachtElement=i,this._innerC.x=0,this._innerC.y=0,this._innerC.addChild(this._stuffBox),this._cMain.addChild(this._innerC)}return t.prototype.createInterface=function(){var t=this;console.log("createInterface ShopView"),this._frameTexture=PIXI.Texture.fromImage(sysData.frame.url),this._framePortraitTexture=PIXI.Texture.fromImage(sysData.framePortrait.url),this._frame=new PIXI.Sprite(this._frameTexture),this._frame.x=0,this._frame.y=0,this._backgroundLandscape=PIXI.Texture.fromImage(sysData.backgroundLandscape.url),this._backgroundPortrait=PIXI.Texture.fromImage(sysData.backgroundPortrait.url),this._background=new PIXI.Sprite(this._backgroundLandscape),this._background.x=60,this._background.y=60,this._innerC.addChild(this._frame),this._innerC.addChild(this._background),this._shopBg=PIXI.Sprite.fromImage(sysData.shopBg.url),this._shopBg.anchor.set(.5),this._innerC.addChild(this._shopBg),this._btnShop=new Button(this._innerC,"btnShopBack",sysData.btnShopBlue.name,sysData.btnShopBackSymbol.name,7,100,100),this._scarabGraphics=new PIXI.Graphics,this._scarabGraphics.beginFill(16777215,.5),this._scarabGraphics.drawRect(0,30,47,20),this._scarabGraphics.endFill(),this._scarabPrice=new PIXI.Text("12",{fontFamily:"Arial",fontSize:24,fill:16711680,fontWeight:"bold",align:"center"}),this._scarabPrice.anchor.set(.5,0),this._scarabPrice.position.set(22,25),this._scarab=new AnimationTiles("scarabAnim",45,45,12),this._scarab.startAnim(),this._scarabC.name="scarab",this._scarabC.on("pointerdown",function(){t._stuffDescription.text="Decreases the size of the ball\n and increases its speed, \n for a certain amount of time.",t.dispatch("scarabClicked",[t._stuffState.scarab.click+=1,parseInt(t._scarabPrice.text)])}),this._scarabC.addChild(this._scarab),this._scarabC.addChild(this._scarabGraphics),this._scarabC.addChild(this._scarabPrice),this._allStuffs.push(this._scarabC),this._innerC.addChild(this._scarabC),this._woodTorchGraphics=new PIXI.Graphics,this._woodTorchGraphics.beginFill(16777215,.5),this._woodTorchGraphics.drawRect(0,30,47,20),this._woodTorchGraphics.endFill(),this._woodTorchPrice=new PIXI.Text("10",{fontFamily:"Arial",fontSize:24,fill:16711680,fontWeight:"bold",align:"center"}),this._woodTorchPrice.anchor.set(.5,0),this._woodTorchPrice.position.set(22,25),this._woodTorch=new AnimationTiles("woodTorchAnim",45,45,12),this._woodTorch.startAnim(),this._woodTorchC.name="woodTorch",this._woodTorchC.on("pointerdown",function(){t._stuffDescription.text="Increases the radius \nof view of the ball,\n for a certain amount of time.",t.dispatch("woodTorchClicked",[t._stuffState.woodTorch.click+=1,parseInt(t._woodTorchPrice.text)])}),this._woodTorchC.addChild(this._woodTorch),this._woodTorchC.addChild(this._woodTorchGraphics),this._woodTorchC.addChild(this._woodTorchPrice),this._allStuffs.push(this._woodTorchC),this._innerC.addChild(this._woodTorchC),this._shoesGraphics=new PIXI.Graphics,this._shoesGraphics.beginFill(16777215,.5),this._shoesGraphics.drawRect(0,30,47,20),this._shoesGraphics.endFill(),this._shoesPrice=new PIXI.Text("10",{fontFamily:"Arial",fontSize:24,fill:16711680,fontWeight:"bold",align:"center"}),this._shoesPrice.anchor.set(.5,0),this._shoesPrice.position.set(22,25),this._shoes=new AnimationTiles("shoesAnim",45,45,12),this._shoes.startAnim(),this._shoesC.name="shoes",this._shoesC.on("pointerdown",function(){t._stuffDescription.text="Increases the speed of the ball,\n for a certain amount of time.",t.dispatch("shoesClicked",[t._stuffState.shoes.click+=1,parseInt(t._shoesPrice.text)])}),this._shoesC.addChild(this._shoes),this._shoesC.addChild(this._shoesGraphics),this._shoesC.addChild(this._shoesPrice),this._allStuffs.push(this._shoesC),this._innerC.addChild(this._shoesC),this._eyeOfRaGraphics=new PIXI.Graphics,this._eyeOfRaGraphics.beginFill(16777215,.5),this._eyeOfRaGraphics.drawRect(0,30,47,20),this._eyeOfRaGraphics.endFill(),this._eyeOfRaPrice=new PIXI.Text("20",{fontFamily:"Arial",fontSize:24,fill:16711680,fontWeight:"bold",align:"center"}),this._eyeOfRaPrice.anchor.set(.5,0),this._eyeOfRaPrice.position.set(22,25),this._eyeOfRa=PIXI.Sprite.fromImage(sysData.eyeOfRa.url),this._eyeOfRaC.name="eyeOfRa",this._eyeOfRaC.on("pointerdown",function(){t._stuffDescription.text="We see the exit of the labyrinth\n all the time of the current game.",t.dispatch("eyeOfRaClicked",[t._stuffState.eyeOfRa.click+=1,parseInt(t._eyeOfRaPrice.text)])}),this._eyeOfRaC.addChild(this._eyeOfRa),this._eyeOfRaC.addChild(this._eyeOfRaGraphics),this._eyeOfRaC.addChild(this._eyeOfRaPrice),this._allStuffs.push(this._eyeOfRaC),this._innerC.addChild(this._eyeOfRaC),this._papyrusGraphics=new PIXI.Graphics,this._papyrusGraphics.beginFill(16777215,.5),this._papyrusGraphics.drawRect(0,30,47,20),this._papyrusGraphics.endFill(),this._papyrusPrice=new PIXI.Text("20",{fontFamily:"Arial",fontSize:24,fill:16711680,fontWeight:"bold",align:"center"}),this._papyrusPrice.anchor.set(.5,0),this._papyrusPrice.position.set(22,25),this._papyrus=new AnimationTiles("papyrusAnim",45,45,10),this._papyrus.startAnim(),this._papyrusC.name="papyrus",this._papyrusC.on("pointerdown",function(){t._stuffDescription.text="Removes part of the mist\n of the labyrinth throughout the game.",t.dispatch("papyrusClicked",[t._stuffState.papyrus.click+=1,parseInt(t._papyrusPrice.text)])}),this._papyrusC.addChild(this._papyrus),this._papyrusC.addChild(this._papyrusGraphics),this._papyrusC.addChild(this._papyrusPrice),this._allStuffs.push(this._papyrusC),this._innerC.addChild(this._papyrusC),this._stuffDescription=new PIXI.Text("",{fontFamily:"Arial",fontSize:18,fill:16777215,fontWeight:"bold",align:"center"}),this._stuffDescription.visible=!1,this._innerC.addChild(this._stuffDescription),this._money=new PIXI.Text("0",{fontFamily:"Arial",fontSize:40,fill:16777215,fontWeight:"bold",align:"center"}),this._money.anchor.set(.5),this._innerC.addChild(this._money)},t.prototype.orientation=function(t){t?(this._background.texture=this._backgroundLandscape,this._frame.texture=this._frameTexture,this._shopBg.x=683,this._shopBg.y=385.5,this._btnShop.x=1072,this._btnShop.y=640,this._stuffState.scarab.pos=[[780,395],[780,395]],this._stuffState.woodTorch.pos=[[550,320],[550,320]],this._stuffState.shoes.pos=[[550,395],[550,395]],this._stuffState.eyeOfRa.pos=[[630,395],[630,395]],this._stuffState.papyrus.pos=[[705,395],[705,395]],this._allStuffPos=[[385,507],[455,507],[525,507],[385,567],[455,567]],this.begin(!1),this._money.position.set(683,100),this._stuffDescription.position.set(640,620)):(this._background.texture=this._backgroundPortrait,this._frame.texture=this._framePortraitTexture,this._shopBg.x=384,this._shopBg.y=683,this._btnShop.x=635,this._btnShop.y=1070,this._stuffState.scarab.pos=[[480,690],[480,690]],this._stuffState.woodTorch.pos=[[250,608],[250,608]],this._stuffState.shoes.pos=[[250,690],[250,690]],this._stuffState.eyeOfRa.pos=[[330,690],[330,690]],this._stuffState.papyrus.pos=[[405,690],[405,690]],this._allStuffPos=[[85,800],[150,800],[220,800],[85,865],[150,865]],this.begin(!1),this._money.position.set(394,410),this._stuffDescription.position.set(350,915))},t.prototype.begin=function(t){this._stuffDescription.text="";for(var i=0;i<this._allStuffs.length;i++){var e=this._allStuffs[i].name;e&&(t&&(this._stuffBox.removeChildren(),this._stuffState[e].click=0,this._innerC.addChild(this._allStuffs[i])),console.log("BVBVB ",e,this._stuffState[e].click),2!=this._stuffState[e].click&&(this._allStuffs[i].x=this._stuffState[e].pos[this._stuffState[e].click][0],this._allStuffs[i].y=this._stuffState[e].pos[this._stuffState[e].click][1]),this._allStuffs[i].buttonMode=!0,this._allStuffs[i].interactive=!0,this.setStuffBoxPos())}},t.prototype.getResouces=function(){return this._images},t.prototype.setMoney=function(t){if(!(t>=0))throw console.log("shopView - setMoney"),new Error("!!!***Invalid credit value***!!!");this._money.text=t.toString()},t.prototype.showStuffDescription=function(t){this._stuffDescription.visible=t},t.prototype.setStuffBoxPos=function(){for(var t=0;t<this._stuffBox.children.length;t++)this._stuffBox.getChildAt(t).x=this._allStuffPos[t][0],this._stuffBox.getChildAt(t).y=this._allStuffPos[t][1];this._innerC.addChild(this._stuffBox)},t.prototype.setScarab=function(t){this._stuffState.scarab.click=t,2==t?this._stuffBox.addChild(this._scarabC):(0==t&&(this._stuffBox.removeChild(this._scarabC),this._innerC.addChild(this._scarabC)),this._scarabC.x=this._stuffState.scarab.pos[this._stuffState.scarab.click][0],this._scarabC.y=this._stuffState.scarab.pos[this._stuffState.scarab.click][1]),this.setStuffBoxPos()},t.prototype.setWoodTorch=function(t){this._stuffState.woodTorch.click=t,2==t?this._stuffBox.addChild(this._woodTorchC):(0==t&&(this._stuffBox.removeChild(this._woodTorchC),this._innerC.addChild(this._woodTorchC)),this._woodTorchC.x=this._stuffState.woodTorch.pos[t][0],this._woodTorchC.y=this._stuffState.woodTorch.pos[t][1]),this.setStuffBoxPos()},t.prototype.setShoes=function(t){this._stuffState.shoes.click=t,2==t?this._stuffBox.addChild(this._shoesC):(0==t&&(this._stuffBox.removeChild(this._shoesC),this._innerC.addChild(this._shoesC)),this._shoesC.x=this._stuffState.shoes.pos[this._stuffState.shoes.click][0],this._shoesC.y=this._stuffState.shoes.pos[this._stuffState.shoes.click][1]),this.setStuffBoxPos()},t.prototype.setEyeOfRa=function(t){this._stuffState.eyeOfRa.click=t,2==t?this._stuffBox.addChild(this._eyeOfRaC):(0==t&&(this._stuffBox.removeChild(this._eyeOfRaC),this._innerC.addChild(this._eyeOfRaC)),this._eyeOfRaC.x=this._stuffState.eyeOfRa.pos[this._stuffState.eyeOfRa.click][0],this._eyeOfRaC.y=this._stuffState.eyeOfRa.pos[this._stuffState.eyeOfRa.click][1]),this.setStuffBoxPos()},t.prototype.setPapyrus=function(t){this._stuffState.papyrus.click=t,2==t?this._stuffBox.addChild(this._papyrusC):(0==t&&(this._stuffBox.removeChild(this._papyrusC),this._innerC.addChild(this._papyrusC)),this._papyrusC.x=this._stuffState.papyrus.pos[this._stuffState.papyrus.click][0],this._papyrusC.y=this._stuffState.papyrus.pos[this._stuffState.papyrus.click][1]),this.setStuffBoxPos()},t.prototype.dispatch=function(t,i){var e=new CustomEvent(t,{detail:i});this._dispachtElement.dispatchEvent(e)},t}(),GameView=function(){function t(t,i){var e=this;this._innerC=new PIXI.Container,this._images=[{name:"bg_header",url:"pics/1366x768/game_header_bg.png"},{name:"backgroundgamePortrait",url:"pics/1366x768/bg_game_portrait.png"},{name:"gameFrame",url:"pics/1366x768/game_frame.png"},{name:"innerBg1",url:"pics/1366x768/innerBg1.png"},{name:"innerBg2",url:"pics/1366x768/innerBg2.png"},{name:"stuffBarLeft",url:"pics/1366x768/stuff_bar_left_game.png"},{name:"stuffBarRight",url:"pics/1366x768/stuff_bar_right_game.png"},{name:"stuffBarPortreat",url:"pics/1366x768/stuff_bar_portrait.png"},{name:"bigBall",url:"pics/BigBall.png"},{name:"stoneLine",url:"pics/stoneLine.png"},{name:"moneySign",url:"pics/1366x768/dollar_sign_game.png"},{name:"timeSign",url:"pics/1366x768/time_sign_game.png"},{name:"levelSign",url:"pics/1366x768/level_sign_game.png"},{name:"coin",url:"pics/coin_anim.png"},{name:"compass",url:"pics/compass_anim.png"},{name:"exit",url:"pics/exit_anim.png"},{name:"moneyCase",url:"pics/case_anim.png"},{name:"tortoise",url:"pics/tortoies_anim.png"},{name:"moneyAnim000",url:"pics/moneyAnim/bigWinAnim000.png"},{name:"moneyAnim001",url:"pics/moneyAnim/bigWinAnim001.png"},{name:"moneyAnim002",url:"pics/moneyAnim/bigWinAnim002.png"},{name:"moneyAnim003",url:"pics/moneyAnim/bigWinAnim003.png"},{name:"moneyAnim004",url:"pics/moneyAnim/bigWinAnim004.png"},{name:"moneyAnim005",url:"pics/moneyAnim/bigWinAnim005.png"},{name:"moneyAnim006",url:"pics/moneyAnim/bigWinAnim006.png"},{name:"moneyAnim007",url:"pics/moneyAnim/bigWinAnim007.png"},{name:"moneyAnim008",url:"pics/moneyAnim/bigWinAnim008.png"},{name:"moneyAnim009",url:"pics/moneyAnim/bigWinAnim009.png"},{name:"moneyAnim010",url:"pics/moneyAnim/bigWinAnim010.png"},{name:"moneyAnim011",url:"pics/moneyAnim/bigWinAnim011.png"},{name:"moneyAnim012",url:"pics/moneyAnim/bigWinAnim012.png"},{name:"moneyAnim013",url:"pics/moneyAnim/bigWinAnim013.png"},{name:"moneyAnim014",url:"pics/moneyAnim/bigWinAnim014.png"},{name:"moneyAnim015",url:"pics/moneyAnim/bigWinAnim015.png"},{name:"moneyAnim016",url:"pics/moneyAnim/bigWinAnim016.png"},{name:"moneyAnim017",url:"pics/moneyAnim/bigWinAnim017.png"},{name:"moneyAnim018",url:"pics/moneyAnim/bigWinAnim018.png"},{name:"moneyAnim019",url:"pics/moneyAnim/bigWinAnim019.png"},{name:"moneyAnim020",url:"pics/moneyAnim/bigWinAnim020.png"},{name:"moneyAnim021",url:"pics/moneyAnim/bigWinAnim021.png"},{name:"moneyAnim022",url:"pics/moneyAnim/bigWinAnim022.png"},{name:"moneyAnim023",url:"pics/moneyAnim/bigWinAnim023.png"},{name:"moneyAnim024",url:"pics/moneyAnim/bigWinAnim024.png"},{name:"moneyAnim025",url:"pics/moneyAnim/bigWinAnim025.png"},{name:"moneyAnim026",url:"pics/moneyAnim/bigWinAnim026.png"},{name:"moneyAnim027",url:"pics/moneyAnim/bigWinAnim027.png"},{name:"moneyAnim028",url:"pics/moneyAnim/bigWinAnim028.png"},{name:"moneyAnim029",url:"pics/moneyAnim/bigWinAnim029.png"},{name:"moneyAnim030",url:"pics/moneyAnim/bigWinAnim030.png"},{name:"moneyAnim031",url:"pics/moneyAnim/bigWinAnim031.png"},{name:"moneyAnim032",url:"pics/moneyAnim/bigWinAnim032.png"},{name:"moneyAnim033",url:"pics/moneyAnim/bigWinAnim033.png"},{name:"moneyAnim034",url:"pics/moneyAnim/bigWinAnim034.png"}],this._moneyAnimTextures=[],this._allWalls=[],this._moveMatrix=[],this._tilePizzleCoor=[[[96,141,0],[117,141,0],[207,149,90],[211,206,0],[955,650,0],[303,206,0],[334,145,90],[305,140,0],[458,147,90],[525,91,90],[752,91,90],[757,143,0],[825,143,0],[916,148,90],[33,245,0],[91,317,0],[91,325,90],[158,318,90],[92,405,90],[100,494,0],[201,475,90],[211,565,0],[33,560,0],[271,325,90],[272,404,90],[276,355,0],[236,382,0],[277,450,0],[402,425,90],[381,515,0],[471,472,90],[481,562,0],[581,562,0],[681,562,0],[781,562,0],[827,562,0],[883,482,0],[820,482,0],[720,482,0],[916,392,90],[916,324,90],[734,320,90],[555,482,0],[567,392,90],[476,392,0],[476,293,90],[481,327,0],[408,284,0],[849,323,90],[791,323,90],[698,319,0],[762,253,0],[690,253,0],[590,253,0],[920,410,0],[630,205,90],[630,150,90],[598,186,0],[1045,495,0],[1045,550,90],[980,410,0],[1040,140,90],[1040,240,90],[1045,500,90],[33,650,0],[133,650,0],[320,650,0],[420,650,0],[520,650,0],[720,650,0],[785,650,0]],[[135,140,0],[234,140,0],[1045,140,0],[432,140,0],[531,140,0],[630,140,0],[730,140,0],[827,140,0],[135,141,90],[275,141,90],[135,211,90],[275,231,0],[373,231,0],[472,231,0],[572,231,0],[672,209,90],[754,253,0],[916,207,90],[135,310,90],[237,318,0],[370,293,90],[370,325,90],[476,293,90],[672,286,90],[754,320,90],[916,305,90],[136,400,0],[181,400,0],[272,404,90],[476,392,0],[672,370,90],[916,404,90],[38,562,0],[112,471,0],[133,470,90],[211,562,0],[272,404,90],[272,470,90],[309,562,0],[381,483,0],[408,562,0],[427,465,90],[506,562,0],[574,482,0],[672,469,90],[672,562,0],[731,562,0],[827,562,0],[758,482,0],[820,482,0],[915,472,90],[38,640,0],[138,640,0],[238,640,0],[338,640,0],[510,640,0],[610,640,0],[710,640,0],[810,640,0],[910,640,0],[990,640,0],[990,562,0],[1045,495,0],[920,430,0],[980,430,0],[1040,140,90],[1040,240,90]],[[92,262,90],[160,92,90],[160,332,90],[240,149,90],[381,211,90],[238,275,90],[307,211,90],[307,275,90],[3e3,210,90],[381,272,90],[455,310,90],[455,212,90],[546,212,90],[546,310,90],[546,400,90],[615,208,90],[615,266,90],[615,429,90],[615,528,90],[695,269,90],[763,269,90],[830,269,90],[918,268,90],[240,142,0],[267,142,0],[363,142,0],[460,142,0],[456,207,0],[593,142,0],[689,142,0],[889,142,0],[615,200,0],[773,200,0],[828,200,0],[695,263,0],[827,263,0],[39,425,0],[139,425,0],[239,425,0],[298,425,0],[684,422,0],[890,422,0],[39,493,0],[262,493,0],[362,492,0],[456,492,0],[621,488,0],[791,487,0],[890,487,0],[110,559,0],[210,559,0],[309,559,0],[459,559,0],[620,554,0],[718,554,0],[817,554,0],[33,650,0],[133,650,0],[320,650,0],[420,650,0],[720,650,0],[785,650,0],[985,650,0],[1045,650,0],[1060,143,90],[1060,233,90],[1060,400,90],[1060,500,90]],[[130,262,0],[230,262,0],[225,162,90],[225,262,90],[480,262,0],[580,262,0],[575,162,90],[575,262,90],[780,262,0],[880,262,0],[875,162,90],[875,262,90],[130,562,0],[230,562,0],[225,462,90],[225,562,90],[480,562,0],[580,562,0],[575,462,90],[575,562,90],[780,562,0],[880,562,0],[875,462,90],[875,562,90]]],this._ballBoxPos=[10,10],this._allInnerBg=[],this._gameStuffPosition=[],this._allGifts=[],this._speedBox=2,this._visualRange=90,this._GSInnerX=128,this._GSInnerY=115,this._rowM=320,this._colM=558,this._moveBoxSize=2,this._ballBox=10,this._timeStop=!1,this._ballMoveStarted=!1,this._showMazePapyrus=!1,this._showExitTile=!1,this._fogC=new PIXI.Container,this._clientTouchData={},this._rotateC=new PIXI.Container,this._cMain=t,this._dispachtElement=i,this._innerC.x=0,this._innerC.y=0,this._innerC.name="innerC",this._cMain.addChild(this._innerC),this._cMain.addChild(this._rotateC),MainController.IS_MOBILE&&(this._innerC.interactive=!0,this._innerC.on("pointerdown",function(t){e.touchMoveBall(t)}),this._innerC.on("pointerup",function(){e.touchEnd()}),this._clientTouchData={clickX:0,clickY:0,ballX:0,ballY:0})}return t.prototype.createInterface=function(){var t=this;console.log("createInterface ShopView"),this._bgHeader=PIXI.Sprite.fromImage(sysData.bg_header.url),this._bgHeader.anchor.set(.5,0),this._bgHeader.y=0,this._backgroundPortrait=PIXI.Texture.fromImage(sysData.backgroundgamePortrait.url),this._background=new PIXI.Sprite(this._backgroundPortrait),this._background.x=0,this._background.y=100,this._gameframe=PIXI.Sprite.fromImage(sysData.gameFrame.url),this._gameframe.anchor.set(.5),this._innerC.addChild(this._bgHeader),this._innerC.addChild(this._background),this._innerBg1=PIXI.Sprite.fromImage(sysData.innerBg1.url),this._allInnerBg.push(this._innerBg1),this._innerBg2=PIXI.Sprite.fromImage(sysData.innerBg2.url),this._innerBg2.visible=!1,this._allInnerBg.push(this._innerBg2),this._stuffBarLeft=PIXI.Sprite.fromImage(sysData.stuffBarLeft.url),this._stuffBarLeft.x=0,this._stuffBarLeft.y=100,this._innerC.addChild(this._stuffBarLeft),this._stuffBarRight=PIXI.Sprite.fromImage(sysData.stuffBarRight.url),this._stuffBarRight.x=1253,this._stuffBarRight.y=100,this._innerC.addChild(this._stuffBarRight),this._stuffBarPortreat=PIXI.Sprite.fromImage(sysData.stuffBarPortreat.url),this._stuffBarPortreat.x=0,this._stuffBarPortreat.y=1244,this._innerC.addChild(this._stuffBarPortreat),this._btnPlay=new Button(this._innerC,"btnPlay",sysData.btnPlayGreen.name,sysData.btnPlaySymbol.name,7,100,100),this._moneySign=PIXI.Sprite.fromImage(sysData.moneySign.url),this._innerC.addChild(this._moneySign),this._money=new PIXI.Text("10",{fontFamily:"Arial",fontSize:36,fill:16777215,fontWeight:"bold",align:"center"}),this._money.anchor.set(.5,0),this._innerC.addChild(this._money),this._levelSign=PIXI.Sprite.fromImage(sysData.levelSign.url),this._innerC.addChild(this._levelSign),this._level=new PIXI.Text("1",{fontFamily:"Arial",fontSize:36,fill:16777215,fontWeight:"bold",align:"center"}),this._level.anchor.set(.5,0),this._innerC.addChild(this._level),this._timeSign=PIXI.Sprite.fromImage(sysData.timeSign.url),this._innerC.addChild(this._timeSign),this._time=new PIXI.Text("60",{fontFamily:"Arial",fontSize:36,fill:"0xffffff",fontWeight:"bold",align:"center"}),this._time.anchor.set(.5,0),this._innerC.addChild(this._time),this._coin=new AnimationTiles("coin",45,45,8),this._coin.startAnim(),this._coin.sprite.name="coin",this._allGifts.push(this._coin.sprite),this._compass=new AnimationTiles("compass",45,45,10),this._compass.startAnim(),this._compass.sprite.name="compass",this._allGifts.push(this._compass.sprite),this._exit=new AnimationTiles("exit",45,45,13),this._exit.startAnim(),this._exit.sprite.name="exit",this._allGifts.push(this._exit.sprite),this._moneyCase=new AnimationTiles("moneyCase",45,45,8),this._moneyCase.startAnim(),this._moneyCase.sprite.name="moneyCase",this._allGifts.push(this._moneyCase.sprite),this._tortoise=new AnimationTiles("tortoise",45,45,10),this._tortoise.startAnim(),this._tortoise.sprite.name="tortoise",this._allGifts.push(this._tortoise.sprite),this._papyrus=new AnimationTiles("papyrusAnim",45,45,10,this._innerC),this._papyrus.startAnim(),this._papyrus.sprite.name="papyrus",this._papyrus.sprite.anchor.set(.5),this._papyrus.sprite.visible=!0,this._papyrus.sprite.buttonMode=!0,this._papyrus.sprite.interactive=!0,this._papyrus.sprite.on("pointerdown",function(){t._btnPlay.status||(t.showMaze(),t._papyrus.sprite.visible=!1)}),this._scarab=new AnimationTiles("scarabAnim",45,45,12,this._innerC),this._scarab.startAnim(),this._scarab.sprite.name="scarab",this._scarab.sprite.anchor.set(.5),this._scarab.sprite.visible=!0,this._scarab.sprite.buttonMode=!0,this._scarab.sprite.interactive=!0,this._scarab.sprite.on("pointerdown",function(){t._btnPlay.status||(t.scarabWasClicked(),t._scarab.sprite.visible=!1)}),this._shoes=new AnimationTiles("shoesAnim",45,45,12,this._innerC),this._shoes.startAnim(),this._shoes.sprite.name="shoes",this._shoes.sprite.anchor.set(.5),this._shoes.sprite.visible=!1,this._shoes.sprite.buttonMode=!0,this._shoes.sprite.interactive=!0,this._shoes.sprite.on("pointerdown",function(){t._btnPlay.status||(t.shoesWasClicked(),t._shoes.sprite.visible=!1)}),this._woodTorch=new AnimationTiles("woodTorchAnim",45,45,12,this._innerC),this._woodTorch.startAnim(),this._woodTorch.sprite.name="woodTorch",this._woodTorch.sprite.anchor.set(.5),this._woodTorch.sprite.visible=!0,this._woodTorch.sprite.buttonMode=!0,this._woodTorch.sprite.interactive=!0,this._woodTorch.sprite.on("pointerdown",function(){t._btnPlay.status||(t.woodTorchWasClicked(),t._woodTorch.sprite.visible=!1)}),this._eyeOfRa=PIXI.Sprite.fromImage(sysData.eyeOfRa.url),this._eyeOfRa.name="eyeOfRa",this._eyeOfRa.anchor.set(.5),this._eyeOfRa.visible=!0,this._eyeOfRa.buttonMode=!0,this._eyeOfRa.interactive=!0,this._eyeOfRa.on("pointerdown",function(){t._btnPlay.status||(t._showExitTile=!0,t._fogC.removeChild(t._exit.sprite),t._rotateC.addChild(t._exit.sprite),t._eyeOfRa.visible=!1)}),this._innerC.addChild(this._eyeOfRa),this._bigBall=PIXI.Sprite.fromImage(sysData.bigBall.url),this._bigBall.anchor.set(.5),this._maskFog=new PIXI.Graphics,this._fog=new PIXI.Graphics,this._fog.beginFill(0,1),this._fog.drawRect(0,0,1112,638),this._fog.endFill(),this._fogC.name="fogC",this._fogC.x=0,this._fogC.y=0,this._fogC.addChild(this._innerBg1),this._fogC.addChild(this._innerBg2),this._fogC.addChild(this._bigBall),this._fogC.addChild(this._compass.sprite),this._fogC.addChild(this._coin.sprite),this._fogC.addChild(this._exit.sprite),this._fogC.addChild(this._moneyCase.sprite),this._fogC.addChild(this._tortoise.sprite),this._fogC.mask=this._maskFog,this._rotateC.addChild(this._fog),this._rotateC.addChild(this._fogC),this._innerC.addChild(this._gameframe),this._allStuff={papyrus:this._papyrus.sprite,scarab:this._scarab.sprite,shoes:this._shoes.sprite,woodTorch:this._woodTorch.sprite,eyeOfRa:this._eyeOfRa},this.makeLevelPazzle();for(var i=0;i<35;i++){var e=i<10?"moneyAnim00"+i:"moneyAnim0"+i,s=PIXI.Texture.from(sysData[e].url);this._moneyAnimTextures.push(s)}this._moneyAnim=new PIXI.extras.AnimatedSprite(this._moneyAnimTextures),this._moneyAnim.visible=!1,this._moneyAnim.anchor.set(.5),this._moneyAnim.scale.x=1.5,this._moneyAnim.scale.y=1.5,this._moneyAnim.animationSpeed=.4,this._cMain.addChild(this._moneyAnim)},t.prototype.orientation=function(t){if(t){this._rotateC.rotation=0,this._rotateC.x=this._GSInnerX,this._rotateC.y=this._GSInnerY,this._background.visible=!1,this._bgHeader.x=683,this._gameframe.x=683,this._gameframe.y=434,this._gameframe.rotation=0,this._stuffBarLeft.visible=!0,this._stuffBarRight.visible=!0,this._stuffBarPortreat.visible=!1,this._btnPlay.x=1310,this._btnPlay.y=712,this._timeSign.x=1277,this._timeSign.y=130,this._levelSign.x=1277,this._levelSign.y=313,this._moneySign.x=1277,this._moneySign.y=490,this._time.position.set(1310,225),this._level.position.set(1310,405),this._money.position.set(1310,585),this._moneyAnim.x=683,this._moneyAnim.y=478;for(var i=0;i<this._allGifts.length;i++)this._allGifts[i].rotation=0;this._gameStuffPosition=[[55,170,0],[55,240,0],[55,310,0],[55,385,0],[55,450,0],[55,530,0]];var e=0;for(var i in this._allStuff)this._allStuff[i].scale.x=1,this._allStuff[i].scale.y=1,this._allStuff[i].x=this._gameStuffPosition[e][0],this._allStuff[i].y=this._gameStuffPosition[e][1],e++}else{this._rotateC.rotation=2*Math.PI*.25,this._rotateC.x=702,this._rotateC.y=117,this._background.visible=!0,this._bgHeader.x=384,this._stuffBarLeft.visible=!1,this._stuffBarRight.visible=!1,this._stuffBarPortreat.visible=!0,this._gameframe.x=384,this._gameframe.y=673,this._gameframe.rotation=2*Math.PI*.25,this._btnPlay.x=717,this._btnPlay.y=1310,this._timeSign.x=508,this._timeSign.y=1272,this._levelSign.x=340,this._levelSign.y=1272,this._moneySign.x=160,this._moneySign.y=1272,this._time.position.set(618,1288),this._level.position.set(450,1288),this._money.position.set(270,1288),this._moneyAnim.x=384,this._moneyAnim.y=954;for(i=0;i<this._allGifts.length;i++)this._allGifts[i].rotation=-2*Math.PI*.25;this._gameStuffPosition=[[35,1280,0],[75,1280,0],[115,1280,0],[35,1330,0],[75,1330,0],[115,1330,0]];e=0;for(var i in this._allStuff)this._allStuff[i].scale.x=.7,this._allStuff[i].scale.y=.7,this._allStuff[i].x=this._gameStuffPosition[e][0],this._allStuff[i].y=this._gameStuffPosition[e][1],e++}var s=this._bigBall.getBounds(),n=this._moveBoxSize*this._ballBox;this._maskFog.clear(),this._maskFog.beginFill(16777215,.5),this._maskFog.drawCircle(s.x+n,s.y+n,this._visualRange),this._maskFog.endFill()},t.prototype.restoreInit=function(){this._papyrus.sprite.visible=!1,this._scarab.sprite.visible=!1,this._shoes.sprite.visible=!1,this._woodTorch.sprite.visible=!1,this._eyeOfRa.visible=!1,this._bigBall.scale.x=1,this._bigBall.scale.y=1,this._ballBoxPos[0]=10,this._ballBoxPos[1]=10,this._bigBall.x=this._ballBoxPos[0]*this._moveBoxSize,this._bigBall.y=this._ballBoxPos[1]*this._moveBoxSize;var t=this._bigBall.getBounds(),i=this._moveBoxSize*this._ballBox;this._maskFog.clear(),this._maskFog.beginFill(16777215,.5),this._maskFog.drawCircle(t.x+i,t.y+i,this._visualRange),this._maskFog.endFill(),this._speedBox=2,this._ballBox=10,this._time.style.fill="#ffffff";for(var e=0;e<this._gameStuffPosition.length;e++)this._gameStuffPosition[e][2]=0;for(e=0;e<this._allGifts.length;e++)"innerC"===this._allGifts[e].parent.name&&(this._innerC.removeChild(this._allGifts[e]),this._fogC.addChild(this._allGifts[e]),this._allGifts[e].visible=!0),this._allGifts[e].visible=!0;this.shuffleGiftPosition(),this.chooseInnerBg(),this._showMazePapyrus&&this.hideMaze(),this._showExitTile&&(this._showExitTile=!1,this._rotateC.removeChild(this._exit.sprite),this._fogC.addChild(this._exit.sprite))},t.prototype.chooseInnerBg=function(){for(var t=0;t<this._allInnerBg.length;t++)this._allInnerBg[t].visible=!1;this._allInnerBg[Math.floor(Math.random()*this._allInnerBg.length)].visible=!0},t.prototype.startGameTime=function(){var t=this;this._timeStop=!1,this._gameTimer=setInterval(function(){t.setTime(--t._gameTime),0===t._gameTime&&(t.stopGameTime(),clearInterval(t._ballTimer),t.dispatch("timeOver")),t._gameTime<6&&(MainController.HAVE_SOUND&&createjs.Sound.play("timeIsUpSound"),t._time.style.fill="#d6172d")},1e3)},t.prototype.stopGameTime=function(){clearInterval(this._gameTimer),this._timeStop=!0},t.prototype.startStuff=function(t){for(var i=0;i<t.length;i++){var e=this.getStuffPos();this._allStuff[t[i]].x=e[0],this._allStuff[t[i]].y=e[1],this._allStuff[t[i]].visible=!0}},t.prototype.shuffleGiftPosition=function(){for(var t=0,i=0,e=0;e<this._allGifts.length;e++){var s=this.calcPos();s[0]==t&&s[1]==i?e--:(t=s[0],i=s[1],this._allGifts[e].x=t,this._allGifts[e].y=i)}},t.prototype.calcPos=function(){return[Math.floor(800*Math.random())+280,Math.floor(400*Math.random())+200]},t.prototype.checkHitGiftTiles=function(){for(var t=this._bigBall.getBounds(),i=0;i<this._allGifts.length;i++){var e=this._allGifts[i].getBounds();t.y<e.y+e.height&&t.y+t.height>e.y&&(t.x>e.x&&t.x<e.x+e.width||t.x<e.x&&t.x+t.width>e.x)&&(console.log("======HIT======",this._allGifts[i].name),this._allGifts[i].visible=!1,this._allGifts[i].x=0,this._allGifts[i].y=0,MainController.HAVE_SOUND&&createjs.Sound.play("getStuff"),this.getStuff(this._allGifts[i].name))}},t.prototype.getStuff=function(t){var i=this;switch(t){case"coin":this.dispatch("hitCoin");break;case"moneyCase":this.dispatch("hitMoneyCase");break;case"exit":this.stopGameTime(),this.touchEnd(),clearInterval(this._ballTimer),this.dispatch("hitExit",[this._gameTime]);break;case"tortoise":this._speedBox=1,setTimeout(function(){i._speedBox=2},6e3);break;case"compass":for(var e=0;e<this._allGifts.length;e++)this._fogC.removeChild(this._allGifts[e]),this._rotateC.addChild(this._allGifts[e]);setTimeout(function(){for(var t=0;t<i._allGifts.length;t++)i._rotateC.removeChild(i._allGifts[t]),i._fogC.addChild(i._allGifts[t])},1500)}},t.prototype.startMoneyCaseAnim=function(t){var i=this;this._moneyAnim.play(),this._moneyAnim.visible=!0;this.stopGameTime(),this._moneyTimer=setInterval(function(){var e=parseInt(i._money.text);i._money.text=(e+=1).toString(),0==--t&&(clearInterval(i._moneyTimer),i._moneyAnim.visible=!1,i._moneyAnim.stop(),i.startGameTime())},40)},t.prototype.getStuffPos=function(){for(var t=0;t<this._gameStuffPosition.length;t++)if(0===this._gameStuffPosition[t][2])return this._gameStuffPosition[t][2]=1,[this._gameStuffPosition[t][0],this._gameStuffPosition[t][1]];throw new Error("!!!***Insufficient size of array _gameStuffPosition***!!!")},t.prototype.setMoney=function(t){if(t<0)throw console.log("setMoney - GameView"),new Error("!!!***Invalid value of Money***!!!");this._money.text=t.toString()},t.prototype.setLevel=function(t){if(t<1)throw console.log("setLevel - GameView"),new Error("!!!***Invalid value of Level***!!!");this._level.text=t.toString()},t.prototype.setTime=function(t){if(!(t>=0))throw console.log("setTime - GameView"),new Error("!!!***Invalid value of Time***!!!");this._gameTime=t,this._time.text=this._gameTime.toString()},t.prototype.showMaze=function(){this._showMazePapyrus=!0;for(var t=0;t<this._allWalls.length;t++)this._fogC.removeChild(this._allWalls[t].tile),this._allWalls[t].tile.alpha=.5,this._rotateC.addChild(this._allWalls[t].tile)},t.prototype.hideMaze=function(){this._showMazePapyrus=!1;for(var t=0;t<this._allWalls.length;t++)this._rotateC.removeChild(this._allWalls[t].tile),this._allWalls[t].tile.alpha=1,this._fogC.addChild(this._allWalls[t].tile)},t.prototype.scarabWasClicked=function(){var t=this;this._bigBall.scale.x=.5,this._bigBall.scale.y=.5,this._speedBox=3,this._ballBox=5,setTimeout(function(){t._bigBall.scale.x=1,t._bigBall.scale.y=1,t._speedBox=2,t._ballBox=10},15e3)},t.prototype.shoesWasClicked=function(){var t=this;this._speedBox=3,setTimeout(function(){t._speedBox=2},1e4)},t.prototype.woodTorchWasClicked=function(){var t=this;this._visualRange=120,this._maskFog.beginFill(16777215,.5),this._maskFog.drawCircle(this._ballBoxPos[0]*this._moveBoxSize+this._GSInnerX,this._ballBoxPos[1]*this._moveBoxSize+this._GSInnerY,this._visualRange),this._maskFog.endFill(),setTimeout(function(){t._visualRange=90},12e3)},t.prototype.checkColision=function(t,i,e){for(var s,n,o=0;o<this._tilePizzleCoor[e].length;o++)if(0==this._tilePizzleCoor[e][o][2]?(s=100,n=10):(s=10,n=100),t>this._tilePizzleCoor[e][o][0]&&t<this._tilePizzleCoor[e][o][0]+s&&i>=this._tilePizzleCoor[e][o][1]&&i<=this._tilePizzleCoor[e][o][1]+n||t>this._tilePizzleCoor[e][o][0]&&t<this._tilePizzleCoor[e][o][0]+s&&i+this._moveBoxSize>=this._tilePizzleCoor[e][o][1]&&i+this._moveBoxSize<=this._tilePizzleCoor[e][o][1]+n||t+this._moveBoxSize>this._tilePizzleCoor[e][o][0]&&t+this._moveBoxSize<this._tilePizzleCoor[e][o][0]+s&&i>this._tilePizzleCoor[e][o][1]&&i<this._tilePizzleCoor[e][o][1]+n||t+this._moveBoxSize>this._tilePizzleCoor[e][o][0]&&t+this._moveBoxSize<this._tilePizzleCoor[e][o][0]+s&&i+this._moveBoxSize>this._tilePizzleCoor[e][o][1]&&i+this._moveBoxSize<this._tilePizzleCoor[e][o][1]+n)return 0;return 1},t.prototype.makeLevelPazzle=function(){var t,i=Math.floor(Math.random()*this._tilePizzleCoor.length),e=0;for(e=0;e<this._tilePizzleCoor[i].length;e++){var s=new StoneTile("stoneLine",100,10,90===this._tilePizzleCoor[i][e][2]?90:0);this._allWalls.push(s),this._fogC.addChild(s.tile)}for(this.setStoneWallPosition(33,88,i),e=0;e<this._rowM;e++){this._moveMatrix.push([]);for(var n=0;n<this._colM;n++)t=this.checkColision(n*this._moveBoxSize+34,e*this._moveBoxSize+88,i),this._moveMatrix[e].push(t)}},t.prototype.setStoneWallPosition=function(t,i,e){for(var s=0;s<this._allWalls.length;s++)this._allWalls[s].setX(this._tilePizzleCoor[e][s][0]-t),this._allWalls[s].setY(this._tilePizzleCoor[e][s][1]-i)},t.prototype.playDisable=function(t){t?this._btnPlay.disable():this._btnPlay.enable()},t.prototype.touchMoveBall=function(t){var i=this;this._ballTimer=setInterval(function(){if(!i._timeStop&&i._gameTime>0){var e=i._bigBall.getBounds();i._clientTouchData.clickX=parseInt(t.data.global.x),i._clientTouchData.clickY=parseInt(t.data.global.y),i._clientTouchData.ballX=parseInt(e.x),i._clientTouchData.ballY=parseInt(e.y),i.touchStart()}},40)},t.prototype.touchStart=function(){this._clientTouchData.ballX<this._clientTouchData.clickX?(this._clientTouchData.clickX-this._clientTouchData.ballX>10&&this.moveBall("right"),(this._clientTouchData.ballY-this._clientTouchData.clickY>10||this._clientTouchData.ballY-this._clientTouchData.clickY<-10)&&(this._clientTouchData.ballY>this._clientTouchData.clickY?this.moveBall("up"):this.moveBall("down"))):(this._clientTouchData.ballX-this._clientTouchData.clickX>10&&this.moveBall("left"),(this._clientTouchData.ballY-this._clientTouchData.clickY>10||this._clientTouchData.ballY-this._clientTouchData.clickY<-10)&&(this._clientTouchData.ballY>this._clientTouchData.clickY?this.moveBall("up"):this.moveBall("down")))},t.prototype.touchEnd=function(){clearInterval(this._ballTimer),MainController.HAVE_SOUND&&this._ballMoveStarted&&(this._ballMoveStarted=!1,this._mBallSound.stop("ballMove"))},t.prototype.stopBallSound=function(){MainController.HAVE_SOUND&&this._ballMoveStarted&&(this._ballMoveStarted=!1,this._mBallSound.stop("ballMove"))},t.prototype.moveBall=function(t){if(MainController.LANDSCAPE||(t="left"==t?"down":"right"==t?"up":"down"==t?"right":"left"),this.hitTestObject(t)&&!this._timeStop&&this._gameTime>0)switch(t){case"left":this._ballBoxPos[0]=this._ballBoxPos[0]-=this._speedBox;break;case"right":this._ballBoxPos[0]=this._ballBoxPos[0]+=this._speedBox;break;case"up":this._ballBoxPos[1]=this._ballBoxPos[1]-=this._speedBox;break;case"down":this._ballBoxPos[1]=this._ballBoxPos[1]+=this._speedBox}var i=this._bigBall.getBounds(),e=this._moveBoxSize*this._ballBox;this._maskFog.clear(),this._maskFog.beginFill(16777215,.5),this._maskFog.drawCircle(i.x+e,i.y+e,this._visualRange),this._maskFog.endFill(),this._bigBall.x=this._ballBoxPos[0]*this._moveBoxSize,this._bigBall.y=this._ballBoxPos[1]*this._moveBoxSize,this.checkHitGiftTiles(),MainController.HAVE_SOUND&&!this._ballMoveStarted&&(this._ballMoveStarted=!0,this._mBallSound=createjs.Sound.play("ballMove",{loop:-1}))},t.prototype.hitTestObject=function(t){var i=0,e=0,s=0;switch(t){case"left":for(s=0;s<2*this._ballBox;s++)this._ballBoxPos[0]-this._ballBox-this._speedBox>0&&this._moveMatrix[this._ballBoxPos[1]-this._ballBox+1*s][this._ballBoxPos[0]-this._ballBox-this._speedBox]>0&&e++;e===2*this._ballBox&&(i=1);break;case"up":for(s=0;s<2*this._ballBox;s++)this._ballBoxPos[1]-this._ballBox-this._speedBox>0&&this._moveMatrix[this._ballBoxPos[1]-this._ballBox-this._speedBox][this._ballBoxPos[0]-this._ballBox+1*s]>0&&e++;e===2*this._ballBox&&(i=1);break;case"right":for(s=0;s<2*this._ballBox;s++)this._ballBoxPos[0]+this._ballBox+this._speedBox<this._colM&&this._moveMatrix[this._ballBoxPos[1]-this._ballBox+1*s][this._ballBoxPos[0]+this._ballBox+this._speedBox]>0&&e++;e===2*this._ballBox&&(i=1);break;case"down":for(s=0;s<2*this._ballBox;s++)this._ballBoxPos[1]+this._ballBox+this._speedBox<this._rowM&&this._moveMatrix[this._ballBoxPos[1]+this._ballBox+this._speedBox][this._ballBoxPos[0]-this._ballBox+1*s]>0&&e++;e===2*this._ballBox&&(i=1)}return i},t.prototype.getResouces=function(){return this._images},t.prototype.dispatch=function(t,i){var e=new CustomEvent(t,{detail:i});this._dispachtElement.dispatchEvent(e)},t}(),SoundChoose=function(){function t(t,i){this._images=[{name:"frame",url:"pics/1366x768/frame.png"},{name:"framePortrait",url:"pics/1366x768/frame_portrait.png"},{name:"sndOn",url:"pics/1366x768/sound_on.png"},{name:"sndOff",url:"pics/1366x768/sound_off.png"},{name:"preloaderBar",url:"pics/preloader_bar.png"},{name:"fullScreenButton",url:"pics/full_screen_button.gif"},{name:"progressBar",url:"pics/progress_bar.png"}],this._cMain=t,this._dispachtElement=i,this._preloadBox=new PIXI.Container,this._visualBox=new PIXI.Container,this._visualBox.x=683,this._visualBox.y=384}return t.prototype.createInterface=function(){var t=this;this.checkForUnloadedBg()||(this._bglandscape=PIXI.Texture.fromImage(sysData.frame.url),this._bgPortrait=PIXI.Texture.fromImage(sysData.framePortrait.url),this._imgBg=new PIXI.Sprite(this._bglandscape),this._cMain.addChild(this._imgBg)),this._txt=new PIXI.Text("Play with sound?",{fontFamily:"Arial",fontSize:32,fill:16777215,align:"center"}),this._txt.anchor.set(.5,0),this._visualBox.addChild(this._txt),this._btnOn=PIXI.Sprite.fromImage(sysData.sndOn.url),this._btnOn.interactive=!0,this._btnOn.buttonMode=!0,this._btnOn.anchor.set(.5,0),this._btnOn.on("pointerdown",function(){var i=new CustomEvent("gameWithSound");t.simulateFullScreen(),setTimeout(function(){t._dispachtElement.dispatchEvent(i)},10),t._cMain.removeChild(t._visualBox),t._cMain.addChild(t._preloadBox)}),this._btnOn.x-=this._btnOn.width,this._btnOn.y=50,this._visualBox.addChild(this._btnOn),this._btnOff=PIXI.Sprite.fromImage(sysData.sndOff.url),this._btnOff.interactive=!0,this._btnOff.buttonMode=!0,this._btnOff.anchor.set(.5,0),this._btnOff.on("pointerdown",function(){var i=new CustomEvent("gameWithoutSound");t.simulateFullScreen(),setTimeout(function(){t._dispachtElement.dispatchEvent(i)},10),t._cMain.removeChild(t._visualBox),t._cMain.addChild(t._preloadBox)}),this._btnOff.x+=this._btnOff.width,this._btnOff.y=50,this._visualBox.addChild(this._btnOff),this._prloaderBar=PIXI.Sprite.fromImage(sysData.preloaderBar.url),this._prloaderBar.x=-this._prloaderBar.width/2,this._progressBar=PIXI.Sprite.fromImage(sysData.progressBar.url),this._progressBar.x=-this._progressBar.width/2,this._progressBar.width=0,this._preloadBox.addChild(this._prloaderBar),this._preloadBox.addChild(this._progressBar),this._loadPercent=new PIXI.Text("0%",{fontFamily:"Arial",fontSize:24,fill:16777215,align:"center"}),this._loadPercent.anchor.set(.5),this._loadPercent.y=-35,this._preloadBox.addChild(this._loadPercent),this._cMain.addChild(this._visualBox)},t.prototype.orientation=function(t){console.log("******************** ",t),t?(this._imgBg.texture=this._bglandscape,this._visualBox.x=683,this._visualBox.y=384,this._preloadBox.x=683,this._preloadBox.y=384):(console.log("PORTRAIT"),this._imgBg.texture=this._bgPortrait,this._visualBox.x=384,this._visualBox.y=683,this._preloadBox.x=384,this._preloadBox.y=683)},t.prototype.simulateFullScreen=function(){var t=document.documentElement;void 0!==document.fullScreenElement&&null===document.fullScreenElement||void 0!==document.msFullscreenElement&&null===document.msFullscreenElement||void 0!==document.mozFullScreen&&!document.mozFullScreen||void 0!==document.webkitIsFullScreen&&!document.webkitIsFullScreen?t.requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):t.msRequestFullscreen&&t.msRequestFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},t.prototype.dafaultBackground=function(){this._bgGraphics=new PIXI.Graphics,this._bgGraphics.position.x=0,this._bgGraphics.position.y=0,this._bgGraphics.lineStyle(0),this._bgGraphics.beginFill(16777215,1),this._bgGraphics.moveTo(0,0),this._bgGraphics.lineTo(1024,0),this._bgGraphics.lineTo(1024,717),this._bgGraphics.lineTo(0,717),this._bgGraphics.lineTo(0,0),this._cMain.addChild(this._bgGraphics)},t.prototype.roteateElement=function(t,i){console.log("$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$"),this._btnOn.rotation=0,t.y=0,t.x=0},t.prototype.getResouces=function(){return this._images},t.prototype.setProgressBar=function(t){if(this._loadPercent){if(!(t>0&&t<101))throw new Error("invalid value load percent!");this._loadPercent.text=t.toString(),this._progressBar.width=Math.round(t/100*this._prloaderBar.width)}},t.prototype.checkForUnloadedBg=function(){for(var t in sysData)if(sysData[t].name=null!==sysData[t].error)return this.dafaultBackground(),!0;return!1},t}(),EndGameView=function(){function t(t){this._cMain=new PIXI.Container,this._innerC=new PIXI.Container,this._cMain=t,this._cMain.addChild(this._innerC)}return t.prototype.createInterface=function(){this._bg=new PIXI.Graphics,this._bg.beginFill(0,1),this._bg.drawRect(0,0,1024,717),this._bg.endFill(),this._innerC.addChild(this._bg),this._btnPlay=new Button(this._innerC,"btnPlay",sysData.btnPlayGreen.name,sysData.btnPlaySymbol.name,7,100,100),this._mess=new PIXI.Text("Play other games?",{fontFamily:"Arial",fontSize:36,fill:16777215,fontWeight:"bold",align:"center"}),this._mess.anchor.set(.5,.5),this._innerC.addChild(this._mess)},t.prototype.orientation=function(t){t?(this._btnPlay.x=683,this._btnPlay.y=464,this._mess.position.set(683,384)):(this._btnPlay.x=384,this._btnPlay.y=763,this._mess.position.set(384,683))},t}();function app(t,i,e){var s=PIXI.autoDetectRenderer(1366,768,{backgroundColor:0});document.body.appendChild(s.view);for(var n=!1,o="undefined",a=[],h="",r=location.search.split("?"),l=r[r.length-1].split("&"),_=0;_<l.length;_++){var c=l[_].split("=");a.push(c)}for(_=0;_<a.length;_++)a[_]&&a[_][0]&&"server_url"==a[_][0]&&(h=a[_][1]),a[_]&&a[_][0]&&"user_name"==a[_][0]&&(o=a[_][1],n=!0);document.getElementById("myForm").setAttribute("action",h+"?isMobile="+e);var m=new MainController(i,s,e,n,o);document.onkeydown=function(t){var i,e=t.keyCode||t.which;switch(console.log("KEYDown:",e),e){case 13:console.log("======== enter ======="),i=new CustomEvent("score_cast"),dispachtElement.dispatchEvent(i);break;case 32:console.log("======== space ======="),i=new CustomEvent("win_cast"),dispachtElement.dispatchEvent(i);break;case 37:m.moveBall("left");break;case 38:m.moveBall("up");break;case 39:m.moveBall("right");break;case 40:m.moveBall("down")}},document.onkeyup=function(t){t.keyCode||t.which;m.stopBallMove()},m.animate()}
